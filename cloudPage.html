V23

<script runat="server">
    Platform.Load("core","1.1");
    try {
      
        var FolderName = "Script";

        var FolderAttributes = Folder.Retrieve({ Property: "Name", SimpleOperator: "equals", Value: FolderName });
        var FolderID = FolderAttributes[0].ID;     
        Write("Folder ID" + FolderID + "<br>");

        var ListOfOptionsDE = DataExtension.Init("Categorias");
        var Rows = ListOfOptionsDE.Rows.Retrieve();
        Write("Rows" + Rows + "<br>");
      
        for(var i in Rows) { 
            var DE = "UsuariosCategoria_" + Rows[i]["Categoria"];
            var obj = {
                "CustomerKey" : DE,
                "Name" : DE,
                "CategoryID": FolderID,
                "Fields" : [
                { "Name" : "SubscriberKey", "FieldType" : "Text", "MaxLength" : 50 }
                ]
            };
            var Status = DataExtension.Add(obj);
            Write("(+) Data Extension Status:" + Status + "<br>");

            var prox = new Script.Util.WSProxy();
            var result = prox.updateItem("QueryDefinition", {
                ObjectID: "50364c91-eedf-4be4-b112-f36de483aeac",             // required
                DataExtensionTarget : {                                       // required. But add Name and CustomerKey only if updating the target DE
                    Name : DE,                                         // Add only if changing the target DE
                    CustomerKey : DE                                   // Add only if changing the target DE, else leave blank
                },
                QueryText : "SELECT SubscriberKey from _Sent"                           // Add only to update the SQL query 
            });
            Write(Stringify(result));

            var qd = "3ea1b61c-6351-44f4-ad1f-a0972249a5b0"
            qd = QueryDefinition.Init(qd);
            var perform_status = qd.Perform();
            Write(Stringify(perform_status));
        }


    } catch (err) {
        Write("(!) Data Extension was not created. Error message: " + err + "<br>")
    }  
</script>